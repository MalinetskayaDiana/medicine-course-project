{% extends "base.html" %}
{% block title %}Список врачей{% endblock %}
{% block content %}
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='style/patient_appointments_style.css') }}">

    <title>Записи</title>
</head>
<header class="doctorListHeader">
    <div class="header container row centerH padding100pxW spacebtw">
        <div class="container row small centerH" id="doctorListHeaderDropdownContainer">
            <!-- <img src="static/images/dropdown.svg" id="dropdown" class="marginW10px"> -->
            <h4 class="thin" id="titleBlack">Записи</h4>
        </div>
        <div class="container row small center">
            <a href="/index">
                <img src="static/images/logo.svg" width="40px" class="marginW30px">
            </a>
        </div>
        <div class="container row small" id="doctorListHeaderProfile">
            <a href="profile">
                <img src="static/images/profileLogo.svg" width="40px" class="marginW10px">
            </a>
            <img src="static/images/menu.png" width="40px" id="menuIcon">
        </div>
    </div>
</header>
<body class="container marginTop120px">
    <div class="menu">
        <div class="container row" id="menuProfileDiv">
            {% if current_user.doctor.photo_path %}
                <img src="{{ url_for('uploaded_file', filename=current_user.patient.photo_path) }}" width="40px">
            {% else %}
                <img src="static/images/profileLogo.svg" width="40px">
            {% endif %}
            <div>
                <h4 id="name">
                {% if current_user.patient %}
                <span>{{ current_user.patient.firstname }} {{ current_user.patient.surname }}</span>
                {% else %}
                <span>{{ current_user.doctor.firstname }} {{ current_user.doctor.surname }}</span>
                {% endif %}
                <h5 id="email">{{ current_user.username }}</h5>
            </div>
        </div>
        <div class="menuItem">
            <img src="static/images/doctorsList.svg" width="40px" style="filter: invert(1);">
            <a href="doctor_list">Наши специалисты</a>
        </div>
        <div class="menuItem active">
            <img src="static/images/appointments.svg" width="40px" style="filter: invert(1);">
            <a href="patient-appointments">Записи</a>
        </div>
        <div class="menuItem">
            <img src="static/images/medicalCard.png" width="40px">
            <a href="medical-card">Медицинская карта</a>
        </div>
    </div>
    <div class="container center">
        <div id="appointmentsTitle">
            <h2>Мои записи</h2>
            <h3>{{ current_user.patient.surname }} {{ current_user.patient.firstname }}</h3>
        </div>
    </div>

    <div class="appointments">
        {% for appointment in patient_appointments %}
            <div class="appointment">
                <div id="apointementsItem">
                    <div class="container row">
                        <img src="{{ url_for('uploaded_file', filename=appointment.doctor.photo_path) }}" width="200px">
                        <div id="apointementData">
                            <h3>{{ appointment.doctor.surname }} {{ appointment.doctor.firstname }}</h3>
                            <div id="date-time">
                                <h3>{{ appointment.appointment_date_time.strftime('%d.%m.%Y') }}</h3> <!-- Вывод только даты в формате 'год-месяц-день' -->
                                <h3>{{ appointment.appointment_date_time.strftime('%H:%M') }}</h3> <!-- Вывод только даты в формате 'год-месяц-день' -->

                            </div>
                        </div>
                    </div>

                    <h5 id="details">Примечания: {{ appointment.appointment_details }}</h5>

                </div>    
            </div>
        {% endfor %}

    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const menuBtn = document.querySelector("#menuIcon"); // Получаем изображение меню
            const menu = document.querySelector(".menu"); // Получаем само меню

            // Показываем или скрываем меню при нажатии на изображение меню
            menuBtn.addEventListener("click", function() {
                if (menu.style.display === "block") {
                    menu.style.display = "none";
                } else {
                    menu.style.display = "block";
                }
            });

            // Скрываем меню при нажатии вне его области
            document.addEventListener("click", function(event) {
                // Проверяем, что клик произошел не на изображении меню и не внутри самого меню
                if (event.target !== menuBtn && !menu.contains(event.target)) {
                    menu.style.display = "none";
                }
            });
        });
    </script>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const closeSidebarBtn = document.querySelector("#closeSidebarBtn");
            const openSidebarBtn =  document.querySelector("#filterIcon");
            const sidebar = document.querySelector(".sidebar"); 
            // Показываем или скрываем меню при нажатии на изображение меню
            openSidebarBtn.addEventListener("click", function() {
                if (sidebar.style.display === "flex") {
                    sidebar.style.display = "none";
                } else {
                    sidebar.style.display = "flex";
                }
            });

            // Скрываем меню при нажатии вне его области
            document.addEventListener("click", function(event) {
                // Проверяем, что клик произошел не на изображении меню и не внутри самого меню
                if (event.target !== openSidebarBtn && !sidebar.contains(event.target)) {
                    sidebar.style.display = "none";
                }
            });

            closeSidebarBtn.addEventListener("click", function(event) {
                    sidebar.style.display = "none";
            });
        });
    </script>

</body>
{% endblock %}
